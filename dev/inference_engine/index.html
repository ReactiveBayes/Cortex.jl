<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Inference Engine: The Brain · Cortex.jl</title><meta name="title" content="Inference Engine: The Brain · Cortex.jl"/><meta property="og:title" content="Inference Engine: The Brain · Cortex.jl"/><meta property="twitter:title" content="Inference Engine: The Brain · Cortex.jl"/><meta name="description" content="Documentation for Cortex.jl."/><meta property="og:description" content="Documentation for Cortex.jl."/><meta property="twitter:description" content="Documentation for Cortex.jl."/><meta property="og:url" content="https://ReactiveBayes.github.io/Cortex.jl/inference_engine/"/><meta property="twitter:url" content="https://ReactiveBayes.github.io/Cortex.jl/inference_engine/"/><link rel="canonical" href="https://ReactiveBayes.github.io/Cortex.jl/inference_engine/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Cortex.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../signals/">Signals: The Core of Reactivity</a></li><li><a class="tocitem" href="../model_backend/">Model Backend: The Foundation</a></li><li class="is-active"><a class="tocitem" href>Inference Engine: The Brain</a><ul class="internal"><li><a class="tocitem" href="#Core-Concepts"><span>Core Concepts</span></a></li><li><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Inference Engine: The Brain</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Inference Engine: The Brain</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ReactiveBayes/Cortex.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ReactiveBayes/Cortex.jl/blob/main/docs/src/inference_engine.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="inference"><a class="docs-heading-anchor" href="#inference">Inference Engine</a><a id="inference-1"></a><a class="docs-heading-anchor-permalink" href="#inference" title="Permalink"></a></h1><p>The <code>InferenceEngine</code> is your gateway to probabilistic inference in Cortex.jl. Think of it as a smart orchestrator that:</p><ul><li>Manages your probabilistic model (through a model backend)</li><li>Coordinates message passing and marginal updates</li><li>Tracks dependencies between computations</li><li>Ensures efficient computation through reactive programming</li></ul><h2 id="Core-Concepts"><a class="docs-heading-anchor" href="#Core-Concepts">Core Concepts</a><a id="Core-Concepts-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Concepts" title="Permalink"></a></h2><h3 id="Model-Backend-Integration"><a class="docs-heading-anchor" href="#Model-Backend-Integration">Model Backend Integration</a><a id="Model-Backend-Integration-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Backend-Integration" title="Permalink"></a></h3><p>The engine wraps your <a href="../model_backend/#model_backend">model backend</a> and provides a unified interface for computing and updating messages and marginals required for inference.</p><h3 id="Reactive-Signal-System"><a class="docs-heading-anchor" href="#Reactive-Signal-System">Reactive Signal System</a><a id="Reactive-Signal-System-1"></a><a class="docs-heading-anchor-permalink" href="#Reactive-Signal-System" title="Permalink"></a></h3><p>Under the hood, the engine uses a <a href="../signals/#signals">reactive signal system</a> to:</p><ul><li>Track dependencies between computations</li><li>Update only what&#39;s necessary when data changes</li><li>Maintain consistency across the model</li></ul><h3 id="Smart-Inference-Execution"><a class="docs-heading-anchor" href="#Smart-Inference-Execution">Smart Inference Execution</a><a id="Smart-Inference-Execution-1"></a><a class="docs-heading-anchor-permalink" href="#Smart-Inference-Execution" title="Permalink"></a></h3><p>The engine optimizes inference by:</p><ul><li>Identifying which parts of the model need updates</li><li>Managing computation order for efficiency</li><li>Handling both local and joint inference tasks</li></ul><h3 id="Inference-Tracing"><a class="docs-heading-anchor" href="#Inference-Tracing">Inference Tracing</a><a id="Inference-Tracing-1"></a><a class="docs-heading-anchor-permalink" href="#Inference-Tracing" title="Permalink"></a></h3><p>The engine provides built-in <a href="#inference_tracing">tracing capabilities</a> for debugging and performance analysis:</p><ul><li>Records timing of signal computations</li><li>Tracks value changes during inference</li><li>Monitors execution order of computations</li><li>Collects warnings and diagnostic information</li></ul><h2 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h2><h3 id="Engine-Management"><a class="docs-heading-anchor" href="#Engine-Management">Engine Management</a><a id="Engine-Management-1"></a><a class="docs-heading-anchor-permalink" href="#Engine-Management" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.InferenceEngine" href="#Cortex.InferenceEngine"><code>Cortex.InferenceEngine</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InferenceEngine{M}</code></pre><p>Core structure for managing and executing probabilistic inference.</p><p><strong>Fields</strong></p><ul><li><code>model_backend::M</code>: The underlying model backend (e.g., a <code>BipartiteFactorGraph</code>).</li><li><code>dependency_resolver</code>: Resolves dependencies between signals during inference.</li><li><code>inference_request_processor</code>: Processes inference requests and manages computation order.</li><li><code>tracer</code>: Optional tracer for monitoring inference execution.</li><li><code>warnings</code>: Collection of <a href="#Cortex.InferenceEngineWarning"><code>InferenceEngineWarning</code></a>s generated during inference.</li></ul><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">InferenceEngine(;
    model_backend::M,
    dependency_resolver = DefaultDependencyResolver(),
    inference_request_processor = InferenceRequestScanner(),
    prepare_signals_metadata::Bool = true,
    resolve_dependencies::Bool = true,
    trace::Bool = false
) where {M}</code></pre><p><strong>Arguments</strong></p><ul><li><code>model_backend</code>: An instance of a supported model backend.</li><li><code>dependency_resolver</code>: Custom dependency resolver (optional).</li><li><code>inference_request_processor</code>: Custom request processor (optional).</li><li><code>prepare_signals_metadata</code>: Whether to initialize signal types and metadata.</li><li><code>resolve_dependencies</code>: Whether to resolve signal dependencies on creation.</li><li><code>trace</code>: Whether to enable inference execution tracing.</li></ul><p>See also: <a href="#Cortex.get_model_backend"><code>get_model_backend</code></a>, <a href="#Cortex.update_marginals!"><code>update_marginals!</code></a>, <a href="#Cortex.request_inference_for"><code>request_inference_for</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L16-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.get_model_backend" href="#Cortex.get_model_backend"><code>Cortex.get_model_backend</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_model_backend(engine::InferenceEngine)</code></pre><p>Retrieves the underlying model backend from the <code>InferenceEngine</code>.</p><p><strong>Arguments</strong></p><ul><li><code>engine::InferenceEngine</code>: The inference engine instance.</li></ul><p><strong>Returns</strong></p><p>The model backend object stored within the engine.</p><p><strong>See Also</strong></p><ul><li><a href="#Cortex.InferenceEngine"><code>InferenceEngine</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L102-L118">source</a></section></article><h3 id="Variable-Operations"><a class="docs-heading-anchor" href="#Variable-Operations">Variable Operations</a><a id="Variable-Operations-1"></a><a class="docs-heading-anchor-permalink" href="#Variable-Operations" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.get_variable_data-Tuple{Cortex.InferenceEngine, Any}" href="#Cortex.get_variable_data-Tuple{Cortex.InferenceEngine, Any}"><code>Cortex.get_variable_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_variable_data(engine::InferenceEngine, variable_id)</code></pre><p>Alias for <code>get_variable_data(get_model_backend(engine), variable_id)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L134-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.get_variable_ids-Tuple{Cortex.InferenceEngine}" href="#Cortex.get_variable_ids-Tuple{Cortex.InferenceEngine}"><code>Cortex.get_variable_ids</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_variable_ids(engine::InferenceEngine)</code></pre><p>Alias for <code>get_variable_ids(get_model_backend(engine))</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L141-L145">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.get_marginal-Tuple{Cortex.InferenceEngine, Any}" href="#Cortex.get_marginal-Tuple{Cortex.InferenceEngine, Any}"><code>Cortex.get_marginal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_marginal(engine::InferenceEngine, variable_id) -&gt; Cortex.Signal</code></pre><p>Alias for <code>get_marginal(get_variable_data(engine, variable_id))</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L148-L152">source</a></section></article><h3 id="Factor-Operations"><a class="docs-heading-anchor" href="#Factor-Operations">Factor Operations</a><a id="Factor-Operations-1"></a><a class="docs-heading-anchor-permalink" href="#Factor-Operations" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.get_factor_data-Tuple{Cortex.InferenceEngine, Any}" href="#Cortex.get_factor_data-Tuple{Cortex.InferenceEngine, Any}"><code>Cortex.get_factor_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_factor_data(engine::InferenceEngine, factor_id)</code></pre><p>Alias for <code>get_factor_data(get_model_backend(engine), factor_id)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L155-L159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.get_factor_ids-Tuple{Cortex.InferenceEngine}" href="#Cortex.get_factor_ids-Tuple{Cortex.InferenceEngine}"><code>Cortex.get_factor_ids</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_factor_ids(engine::InferenceEngine)</code></pre><p>Alias for <code>get_factor_ids(get_model_backend(engine))</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L162-L166">source</a></section></article><h3 id="Message-Passing-Interface"><a class="docs-heading-anchor" href="#Message-Passing-Interface">Message Passing Interface</a><a id="Message-Passing-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Message-Passing-Interface" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.get_message_to_variable-Tuple{Cortex.InferenceEngine, Any, Any}" href="#Cortex.get_message_to_variable-Tuple{Cortex.InferenceEngine, Any, Any}"><code>Cortex.get_message_to_variable</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_message_to_variable(engine::InferenceEngine, variable_id, factor_id) -&gt; Cortex.Signal</code></pre><p>Alias for <code>get_message_to_variable(get_connection(engine, variable_id, factor_id))</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L196-L200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.get_message_to_factor-Tuple{Cortex.InferenceEngine, Any, Any}" href="#Cortex.get_message_to_factor-Tuple{Cortex.InferenceEngine, Any, Any}"><code>Cortex.get_message_to_factor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_message_to_factor(engine::InferenceEngine, variable_id, factor_id) -&gt; Cortex.Signal</code></pre><p>Alias for <code>get_message_to_factor(get_connection(engine, variable_id, factor_id))</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L205-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.get_connected_variable_ids-Tuple{Cortex.InferenceEngine, Any}" href="#Cortex.get_connected_variable_ids-Tuple{Cortex.InferenceEngine, Any}"><code>Cortex.get_connected_variable_ids</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_connected_variable_ids(engine::InferenceEngine, factor_id)</code></pre><p>Alias for <code>get_connected_variable_ids(get_model_backend(engine), factor_id)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L214-L218">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.get_connected_factor_ids-Tuple{Cortex.InferenceEngine, Any}" href="#Cortex.get_connected_factor_ids-Tuple{Cortex.InferenceEngine, Any}"><code>Cortex.get_connected_factor_ids</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_connected_factor_ids(engine::InferenceEngine, variable_id)</code></pre><p>Alias for <code>get_connected_factor_ids(get_model_backend(engine), variable_id)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L223-L227">source</a></section></article><h3 id="Signal-Types"><a class="docs-heading-anchor" href="#Signal-Types">Signal Types</a><a id="Signal-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Signal-Types" title="Permalink"></a></h3><p>The engine uses different signal types to manage various aspects of inference:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.InferenceSignalTypes" href="#Cortex.InferenceSignalTypes"><code>Cortex.InferenceSignalTypes</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InferenceSignalTypes</code></pre><p>Module defining constants for different types of signals used within the inference engine. These types help in dispatching computation rules and managing signal metadata.</p><p><strong>Constants</strong></p><ul><li><a href="#Cortex.InferenceSignalTypes.MessageToVariable"><code>MessageToVariable</code></a>: Signal representing a message from a factor to a variable.</li><li><a href="#Cortex.InferenceSignalTypes.MessageToFactor"><code>MessageToFactor</code></a>: Signal representing a message from a variable to a factor.</li><li><a href="#Cortex.InferenceSignalTypes.ProductOfMessages"><code>ProductOfMessages</code></a>: Signal representing an intermediate product of messages, often a dependency for an <code>IndividualMarginal</code>.</li><li><a href="#Cortex.InferenceSignalTypes.IndividualMarginal"><code>IndividualMarginal</code></a>: Signal representing the marginal distribution of a single variable.</li><li><a href="#Cortex.InferenceSignalTypes.JointMarginal"><code>JointMarginal</code></a>: Signal representing the joint marginal distribution of a set of variables.</li></ul><p><strong>See Also</strong></p><ul><li><a href="#Cortex.prepare_signals_metadata!"><code>prepare_signals_metadata!</code></a></li><li><a href="../signals/#Cortex.Signal"><code>Signal</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L232-L250">source</a></section></article><h4 id="Available-Signal-Types"><a class="docs-heading-anchor" href="#Available-Signal-Types">Available Signal Types</a><a id="Available-Signal-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Available-Signal-Types" title="Permalink"></a></h4><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.InferenceSignalTypes.MessageToVariable" href="#Cortex.InferenceSignalTypes.MessageToVariable"><code>Cortex.InferenceSignalTypes.MessageToVariable</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type constant for a <a href="../signals/#Cortex.Signal"><code>Signal</code></a> representing a message from a factor to a variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L253">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.InferenceSignalTypes.MessageToFactor" href="#Cortex.InferenceSignalTypes.MessageToFactor"><code>Cortex.InferenceSignalTypes.MessageToFactor</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type constant for a <a href="../signals/#Cortex.Signal"><code>Signal</code></a> representing a message from a variable to a factor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L256">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.InferenceSignalTypes.ProductOfMessages" href="#Cortex.InferenceSignalTypes.ProductOfMessages"><code>Cortex.InferenceSignalTypes.ProductOfMessages</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type constant for a <a href="../signals/#Cortex.Signal"><code>Signal</code></a> representing an intermediate product of messages.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L259">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.InferenceSignalTypes.IndividualMarginal" href="#Cortex.InferenceSignalTypes.IndividualMarginal"><code>Cortex.InferenceSignalTypes.IndividualMarginal</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type constant for a <a href="../signals/#Cortex.Signal"><code>Signal</code></a> representing the marginal distribution of a single variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.InferenceSignalTypes.JointMarginal" href="#Cortex.InferenceSignalTypes.JointMarginal"><code>Cortex.InferenceSignalTypes.JointMarginal</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type constant for a <a href="../signals/#Cortex.Signal"><code>Signal</code></a> representing the joint marginal distribution of a set of variables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L265">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.prepare_signals_metadata!" href="#Cortex.prepare_signals_metadata!"><code>Cortex.prepare_signals_metadata!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_signals_metadata!(engine::InferenceEngine)</code></pre><p>Initializes the <code>type</code> and <code>metadata</code> fields for relevant signals within the <code>InferenceEngine</code>.</p><p>This function iterates through variables and factors in the model backend, setting:</p><ul><li>Marginals: <code>type</code> to <a href="#Cortex.InferenceSignalTypes.IndividualMarginal"><code>IndividualMarginal</code></a> and <code>metadata</code> to <code>(variable_id,)</code>.</li><li>Messages to Factors: <code>type</code> to <a href="#Cortex.InferenceSignalTypes.MessageToFactor"><code>MessageToFactor</code></a> and <code>metadata</code> to <code>(variable_id, factor_id)</code>.</li><li>Messages to Variables: <code>type</code> to <a href="#Cortex.InferenceSignalTypes.MessageToVariable"><code>MessageToVariable</code></a> and <code>metadata</code> to <code>(variable_id, factor_id)</code>.</li></ul><p>This setup is typically done once upon engine creation and is crucial for dispatching appropriate computation rules during inference.</p><p><strong>Arguments</strong></p><ul><li><code>engine::InferenceEngine</code>: The inference engine instance whose signals are to be prepared.</li></ul><p><strong>See Also</strong></p><ul><li><a href="#Cortex.InferenceEngine"><code>InferenceEngine</code></a></li><li><a href="#Cortex.InferenceSignalTypes"><code>InferenceSignalTypes</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L287-L307">source</a></section></article><h3 id="Running-Inference"><a class="docs-heading-anchor" href="#Running-Inference">Running Inference</a><a id="Running-Inference-1"></a><a class="docs-heading-anchor-permalink" href="#Running-Inference" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.request_inference_for" href="#Cortex.request_inference_for"><code>Cortex.request_inference_for</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">request_inference_for(engine::InferenceEngine, variable_id_or_ids)</code></pre><p>Creates an <code>InferenceRequest</code> to compute the marginals for the specified <code>variable_id_or_ids</code>.</p><p>This function prepares the necessary signals by marking their dependencies as potentially pending. It supports requesting inference for a single variable ID or a collection (Tuple or AbstractVector) of variable IDs.</p><p><strong>Arguments</strong></p><ul><li><code>engine::InferenceEngine</code>: The inference engine instance.</li><li><code>variable_id_or_ids</code>: A single variable identifier or a collection of variable identifiers.</li></ul><p><strong>Returns</strong></p><ul><li><code>InferenceRequest</code>: An internal structure representing the inference request.</li></ul><p><strong>See Also</strong></p><ul><li><a href="#Cortex.update_marginals!"><code>update_marginals!</code></a></li><li><a href="#Cortex.InferenceEngine"><code>InferenceEngine</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L352-L373">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.InferenceRequest" href="#Cortex.InferenceRequest"><code>Cortex.InferenceRequest</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InferenceRequest{E,V,M}</code></pre><p>Internal structure representing a request to perform inference for a set of variables.</p><p><strong>Fields</strong></p><ul><li><code>engine::E</code>: The inference engine instance.</li><li><code>variable_ids::V</code>: Collection of variable identifiers to compute marginals for.</li><li><code>marginals::M</code>: Collection of marginal signals corresponding to the variables.</li><li><code>readines_status::BitVector</code>: Tracks which variables have been processed.</li></ul><p>See also: <a href="#Cortex.request_inference_for"><code>request_inference_for</code></a>, <a href="#Cortex.update_marginals!"><code>update_marginals!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L331-L344">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.scan_inference_request" href="#Cortex.scan_inference_request"><code>Cortex.scan_inference_request</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Internal function to scan an <code>InferenceRequest</code> and return all pending (dependent) signals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L434">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.InferenceRequestScanner" href="#Cortex.InferenceRequestScanner"><code>Cortex.InferenceRequestScanner</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Internal struct used to scan and collect pending signals from an inference request.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L422">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.process_inference_request" href="#Cortex.process_inference_request"><code>Cortex.process_inference_request</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Internal function to process dependencies for an inference request.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L406">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.process!" href="#Cortex.process!"><code>Cortex.process!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Internal functor for <code>InferenceTaskScanner</code> to collect dependencies.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L429">source</a></section><section><div><p>Internal functor for <code>InferenceRequestProcessor</code> to apply the computation logic.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L454">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.CallbackInferenceRequestProcessor" href="#Cortex.CallbackInferenceRequestProcessor"><code>Cortex.CallbackInferenceRequestProcessor</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Internal struct that wraps a user-provided computation function for processing by <code>update_marginals!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L443">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.update_marginals!" href="#Cortex.update_marginals!"><code>Cortex.update_marginals!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_marginals!(engine::InferenceEngine, variable_id_or_ids)</code></pre><p>Updates the marginals for the specified <code>variable_id_or_ids</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L463-L467">source</a></section></article><h3 id="inference_tracing"><a class="docs-heading-anchor" href="#inference_tracing">Tracing and Debugging</a><a id="inference_tracing-1"></a><a class="docs-heading-anchor-permalink" href="#inference_tracing" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.InferenceEngineWarning" href="#Cortex.InferenceEngineWarning"><code>Cortex.InferenceEngineWarning</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InferenceEngineWarning</code></pre><p>A warning message generated during inference execution.</p><p><strong>Fields</strong></p><ul><li><code>description::String</code>: A human-readable description of the warning.</li><li><code>context::Any</code>: Additional context or data related to the warning.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.TracedInferenceExecution" href="#Cortex.TracedInferenceExecution"><code>Cortex.TracedInferenceExecution</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TracedInferenceExecution</code></pre><p>A record of a single signal computation during inference.</p><p><strong>Fields</strong></p><ul><li><code>engine::InferenceEngine</code>: The inference engine instance.</li><li><code>variable_id</code>: The identifier of the variable being processed.</li><li><code>signal::Signal</code>: The signal that was computed.</li><li><code>total_time_in_ns::UInt64</code>: Total computation time in nanoseconds.</li><li><code>value_before_execution</code>: Signal value before computation.</li><li><code>value_after_execution</code>: Signal value after computation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L546-L559">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.TracedInferenceRound" href="#Cortex.TracedInferenceRound"><code>Cortex.TracedInferenceRound</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TracedInferenceRound</code></pre><p>A record of a single round of inference computations.</p><p><strong>Fields</strong></p><ul><li><code>engine::InferenceEngine</code>: The inference engine instance.</li><li><code>total_time_in_ns::UInt64</code>: Total round time in nanoseconds.</li><li><code>executions::Vector{TracedInferenceExecution}</code>: List of signal computations performed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L610-L620">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.TracedInferenceRequest" href="#Cortex.TracedInferenceRequest"><code>Cortex.TracedInferenceRequest</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TracedInferenceRequest</code></pre><p>A complete record of an inference request execution.</p><p><strong>Fields</strong></p><ul><li><code>engine::InferenceEngine</code>: The inference engine instance.</li><li><code>total_time_in_ns::UInt64</code>: Total request processing time in nanoseconds.</li><li><code>request::InferenceRequest</code>: The original inference request.</li><li><code>rounds::Vector{TracedInferenceRound}</code>: List of inference rounds performed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L627-L638">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Cortex.InferenceEngineTracer" href="#Cortex.InferenceEngineTracer"><code>Cortex.InferenceEngineTracer</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InferenceEngineTracer</code></pre><p>Tracer for monitoring and debugging inference execution.</p><p><strong>Fields</strong></p><ul><li><code>inference_requests::Vector{TracedInferenceRequest}</code>: History of traced inference requests.</li></ul><p>The tracer records:</p><ul><li>Signal computations and their timing</li><li>Value changes during inference</li><li>Execution order of computations</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/Cortex.jl/blob/3441055ab873a8226c71a027e35060b3463a421d/src/inference_engine.jl#L646-L659">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../model_backend/">« Model Backend: The Foundation</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Tuesday 20 May 2025 13:50">Tuesday 20 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
